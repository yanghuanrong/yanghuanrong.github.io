on:
  push:
    branches:
    - master

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨æœ€æ–°çš„ubuntuç³»ç»Ÿ
    steps:
    - name: checkout
      uses: actions/checkout@master # å°†ä»£ç æ‹·è´åˆ°è™šæœºä¸­

    - name: Install and Build ğŸ”§ # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
      run: |
        npm install
        npm run build

    - name: buildAndDeploy
      uses: JamesIves/github-pages-deploy-action@4.1.3
      with:
          branch: gh-pages # The branch the action should deploy to.
          folder: dist # The folder the action should deploy.
      env:
        ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }} # ä½¿ç”¨åˆšæ–°å»ºçš„secret
        BRANCH: gh-pages # å­˜æ”¾äº§ç‰©çš„åˆ†æ”¯åç§°
        FOLDER: dist # å­˜æ”¾buildåäº§ç‰©çš„ç›®å½•
        BUILD_SCRIPT: npm install && npm run build # æ‰§è¡Œçš„å‘½ä»¤

    - name: SyncToGitee
      uses: wearerequired/git-mirror-action@master
      env:
          # æ³¨æ„åœ¨ Settings->Secrets é…ç½® GITEE_RSA_PRIVATE_KEY
          SSH_PRIVATE_KEY: ${{ secrets.GITEE_RSA_PRIVATE_KEY }}
      with:
          # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ GitHub æºä»“åº“åœ°å€
          source-repo: "git@github.com:yanghuanrong/yanghuanrong.github.io.git"
          # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ç›®æ ‡ä»“åº“åœ°å€  
          destination-repo: "git@gitee.com:bsie/bsie.git"

    - name: BuildGiteePages
      uses: yanglbme/gitee-pages-action@master
      with:
          # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ç”¨æˆ·å
          gitee-username: bsie
          # æ³¨æ„åœ¨ Settings->Secrets é…ç½® GITEE_PASSWORD
          gitee-password: ${{ secrets.GITEE_PASSWORD }}
          # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ä»“åº“
          gitee-repo: bsie/bsie
          branch: gh-pages
